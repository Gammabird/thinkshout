---
layout: post
title: Mapping with Drupal
---

<div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p><img alt="compass" height="250" src="http://www.levelos.com/files/compass.png" style="float: right; margin: 0 0 10px 10px; border: none" width="200" /> I've recently become more involved with map scripting in my work on <a href="http://maps.lcrep.org">LCREP</a>, <a href="http://saveourgulf.org/observations">Save Our Gulf</a>, <a href="http://geomeridian.com">Geomeridian</a>, and a few others in the works. One commonality amongst all the projects was the need to display geocoded data on a map, a problem solved many times over. When I began work on the first of these projects this past spring, the state of mapping in <a href="http://drupal.org">Drupal</a> boiled down to these tools.</p>
<h2>Mapedelic</h2>
<p>Mapedelic is the name given to the powerful and well established duo of <a href="http://drupal.org/project/location">Location</a> and <a href="http://drupal.org/project/gmap">Gmap</a>. The former stores address and coordinates as either CCK fields or in its own schema and can geocode addresses when called upon. The latter then renders those locations on a Google map. Gmap also plays well with Views. Both these modules have large install bases and have been in use for some time.</p>
<h3>Pros</h3>
<ul>
<li>Large, well established user base</li>
<li>Stability</li>
<li>Geocoding of addresses</li>
</ul>
<h3>Cons</h3>
<ul>
<li>Location paradigm of collecting addresses is not applicable for more diverse use cases.</li>
<li>Geocoding has some problems when updating addresses.</li>
<li>You can't change between a fields and node based approach. Since fields is by far more flexible, and the future, there's lots of code debt to the pure nodes approach that most people don't need.</li>
<li>Gmap uses the legacy v2 Google Maps API.</li>
<li>Configuration and customization of the Gmaps output can be difficult.</li>
<li>You're locked into using Google Maps.</li>
</ul>
<h2><a href="http://drupal.org/project/openlayers">OpenLayers</a></h2>
<p>From the project page,</p>
<blockquote><p>The OpenLayers Module and its submodules bring the <a href="http://openlayers.org">OpenLayers JS library</a> into Drupal. They enable users to combine maps from different map providers with data from Views and CCK input. The OpenLayers JavaScript library is open source, making it flexible and capable across standards as well as proprietary APIs.</p></blockquote>
<h3>Pros</h3>
<ul>
<li>Well thought out architecture and API allowing for many use cases.</li>
<li>Comes bundled with OpenLayers CCK, a WKT field which can store point, linestring, or polygon data in a single field. It also comes with a "map picker", allowing users to enter data via a map interface.</li>
<li>Ecosystem of supporting modules such as <a href="http://drupal.org/project/openlayers_proximity">OpenLayers Proximity</a>, <a href="http://drupal.org/project/openlayers_geocoder">OpenLayers Geocoder</a>, <a href="http://drupal.org/project/geotaxonomy">Geo Taxonomy</a>, and <a href="http://drupal.org/project/mapbox">MapBox</a>.</li>
<li>Provides a set of tools to mash your Drupal data with external sources, E.g., KML files.</li>
<li>OpenLayers is open source, unlike the proprietary map scripting APIs from Google, Yahoo, and Bing.</li>
</ul>
<h3>Cons</h3>
<ul>
<li>The flexibility translates to a complicated setup and configuration.</li>
<li>Views integration is particularly non-intuitive, as you have to create at least 2 views. One for your data and another simply as a "vehicle" to carry your preset along.</li>
<li>Still in alpha and there are some stability issues.</li>
<li>The OpenLayers library slows to a crawl with more than 500 or so features on a map.</li>
<li>There are potential licensing issues when using tiles from proprietary providers like Google. Basically, OpenLayers directly accesses the map tiles of a given provider without going through their APIs, and that's against Google's TOS unless one gets express permission. Not to mention Google could easily shut down access to it's tiles by OpenLayers, not that there's any indication they would do that.</li>
</ul>
<h2><a href="http://drupal.org/project/geo">Geo</a></h2>
<p>I really want to love this module, as it stores geo data natively in a spatially enabled databases, PostGIS and MySql Spatial specifically. This allows for powerful and efficient spatial queries, such as, do these set of points fall in this polygon, or do these two linestrings intersect and, if so, where? It also provides support for proximity filters within Views. Unfortunately, though, I've found that it's just not ready for production, is very unstable, and difficult to work with. It has also been stuck in alpha for nearly a year, with no new releases since April. One of the challenges that Geo, or any module wanting to implement native spatial data storage, is that the Drupal schema API doesn't support a spatial datatype, although there are some work arounds.</p>
<h2><a href="http://drupal.org/project/gmaps">GMAPS</a></h2>
<blockquote><p>This project integrates the Google Maps API and Google Static Maps API. It makes possible to add addresses and/or coordinates (points) to nodes through CCK fields, display these geographical informations on node pages as text or interactive map or static map and use them on GeoRSS feeds. The project provides style plugins and row style plugins for views to build both interactive and static maps. This project is an independent competitor for the Location and GMap pair (also known as Mapadelic), and this is the successor of the Google Client Geocoder project.</p></blockquote>
<p>I have to admit that I have spent the least amount of time working with this module, but the feature set does look very promising. A couple of things that jump out.</p>
<ul>
<li>It has LOTS of dependencies.</li>
<li>Still using the deprecated V2 of the Google API.</li>
<li>The whole proprietary provider thing.</li>
<li>On the plus side, it implements <a href="http://code.google.com/apis/maps/documentation/staticmaps/">Google Static Maps API</a> which, returns a single map graphic when passes a set of points and other parameters.</li>
</ul>
<h2><a href="http://drupal.org/project/mapstraction">Mapstraction</a></h2>
<p>When we began working on <a href="http://maps.lcrep.org">maps.lcrep.org</a>, I decided that using the <a href="http://mapstraction.com">Mapstraction library</a> was the best option, and in the process I took over the development and maintenance of the module and released a 2.x branch, which uses the newest version of the API and adds many other improvements.</p>
<blockquote><p>This module delivers support for the Mapstraction javascript library, which provides an abstraction layer for the various map providers including Google, Yahoo!, and MapQuest. It allows you to quickly display maps on your site from multiple providers and switch between providers without worrying about differences in their APIs. The module provides a Views style plugin and an API for developers to use maps elsewhere. When the Views style is used, it will display nodes as points on a map. The latitude/longitude points, info balloon contents, map icon, and one or more attributes can be provided by any view fields, including those from CCK. Other settings can be seen on the attached screen shot.</p></blockquote>
<p>The architecture of the module is very simple. Aside from a set of core API calls developers can use in their code to render maps, it exposes a Views style plugin which has options for mapping fields to coordinates, tooltips, map icons, and attributes. The last item is a nice feature of Mapstraction. Any point on a map can have an arbitrary collection of attributes, really name/value pairs, which can then be used to filter the map with a simple Javascript call. That's how we're doing the map filtering on maps.lcrep.org. We also used an updated version of the module, with Google V3 integration, on <a href="http://saveourgulf.org">Save Our Gulf</a>. The module is in fairly active development, and is plotting along with the Mapstraction library. So when an official release of that will be made, I'll do the same with the module.</p>
<h2>Conclusion</h2>
<p>In the end, the right mapping tool of course depends on the requirements. For complex interfaces that display lots of different data, I think OpenLayers might be the way to go, at least if your rendering less than 500 points on a single map. For fairly simple requirements such as plotting points on a map, I think Mapstraction is a great fit, but, of course, I'm biased towards it. All of the tools discussed here are excellent, and, I have to stress, are evolving rapidly, so what might be unstable one day may be polished and ready for production the next. And they all point to the powerful mapping features that can be built with Drupal. I have also begun work on two additional mapping related modules. A dedicated <a href="http://code.google.com/apis/maps/documentation/javascript/">Google Maps Javascript API</a> taking full advantage of the V3 feature set and a fields module integrating with <a href="http://simplegeo.com/">SimpleGeo</a>. Early suggestions welcome!</p>
<p><em>Note that this article was originally published by Lev at <a href="http://www.levelos.com/blog/2010/08/mapping-drupal">http://www.levelos.com/blog/2010/08/mapping-drupal</a>.</em></p>
</div></div></div><div class="field field-name-taxonomy-vocabulary-1 field-type-taxonomy-term-reference field-label-above"><div class="field-label">Tags:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="/blog/category/drupal" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">Drupal</a></div><div class="field-item odd"><a href="/blog/category/mapping" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">mapping</a></div></div></div>
